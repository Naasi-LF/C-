## 第10章 对文件的输入输出

1 . `单选题` `简单` `4分`

```c
以下与函数fseek(fp,0L,SEEK_SET)有相同作用的是（ ）。

A.feof(fp)

B.ftell(fp)

C.fgetc(fp)

D.rewind(fp)✅
```

回答正确

**解析**

(1)int feof(FILE *stream);参数stream是待检测的文件指针。如果文件已到末尾函数返回真（1），否则返回假（0）。 

(2) int fgetc(FILE *stream); 参数stream是已打开的文件指针，该文件必须是以读或读写方式打开的。fgetc函数返回读取从文件中得到的字符数据（低8位），如果在文件末尾则返回EOF 

(3) rewind函数使文件位置重新回到文件开头，其函数原型为： void rewind(FILE *stream); 参数stream是已打开的文件指针。 

(4) fseek函数使文件位置移到任意位置，其函数原型为： 

int fseek(FILE *stream, long offset, int origin);

 参数stream是已打开的文件指针。参数origin表示移动时相对初始点，它必须是如下几个符号常量之一： 

```c
#define	SEEK_SET	0	//移动时相对初始点为文件开头 

#define	SEEK_CUR	1	//移动时相对初始点为文件当前位置 

#define	SEEK_END	2	//移动时相对初始点为文件末尾
```

**老师点评**

暂无评语

**+ 3.0 分**

2 . `单选题` `简单` `3分`

```
下列关于C语言数据文件的叙述中正确的是（ ）。

A.文件由ASCII码字符序列组成，C语言只能读写文本文件

B.文件由二进制数据序列组成，C语言只能读写二进制文件

C.文件由记录序列组成，可按数据的存放形式分为二进制文件和文本文件

D.文件由数据流形式组成，可按数据的存放形式分为二进制文件和文本文件✅
```

回答正确

**解析**

C语言在处理文件时，并不区分文件类型，**都将其看作是一个字符流**，按字符进行处理。即文件由一个一个字符（或字节）的数据顺序组成。输入输出字符流的开始和结束只由程序控制而不受物理符号（如回车符）的控制，因此也把这种文件称作流式文件。

**老师点评**

暂无评语

**+ 3.0 分**

3 . `单选题` `简单` `3分`

```
系统的标准输入文件是指（ ）。

A.键盘✅

B.显示器

C.软盘

D.硬盘
```

**解析**

通常，系统会为每个程序自动定义并打开三个标准文件，分别是标准输入文件stdin（键盘）、标准输出文件stdout（显示器）、标准出错输出stderr（显示器），程序可直接使用它们。例如从文件指针stdin中读取数据就是从键盘上输入数据。

**老师点评**

暂无评语

**+ 3.0 分**

4 . `单选题` `简单` `3分`

```c
系统的标准输出文件是指（ ）。

A.键盘

B.显示器✅

C.软盘

D.硬盘
```

**解析**

通常，系统会为每个程序自动定义并打开三个标准文件，分别是标准输入文件stdin（键盘）、标准输出文件stdout（显示器）、标准出错输出stderr（显示器），程序可直接使用它们。例如从文件指针stdin中读取数据就是从键盘上输入数据。

**老师点评**

暂无评语

**+ 3.0 分**

5 . `单选题` `中等` `3分`

```c
以下叙述中错误的是（ ）。

A.C语言中对二进制文件的访问速度比文本文件快

B.C语言中，随机文件以二进制代码形式存储数据

C.FILE fp; 定义了一个名为fp的文件指针//FILE *fp✅

D.C语言中的文本文件以ASCII码形式存储数据
```

**解析**

ASCII文本文件，数据以字符形式表示，因而便于按字符方式逐个处理，也便于打印输出字符。但ASCII文本文件一般占用存储空间较多，且存在编码转换的运行开销。 C选项中是定义了一个结构体类型的变量，而不是指针。

**老师点评**

暂无评语

**+ 3.0 分**

6 . `单选题` `中等` `3分`

```c
以下叙述中错误的是（ ）。

A.二进制文件打开后可以先读文件的末尾，而顺序文件不可以

B.在程序结束时，应当用fclose函数关闭已打开的文件

C.利用fread函数从二进制文件中读数据时，可以用数组名给数组中所有元素读入数据

D.不可以用FILE定义指向二进制文件的文件指针✅
```

回答正确

**解析**

定义一个文件指针变量FILE *fp; //定义一个文件指针变量 一旦通过函数打开或创建一个文件时，fp就指向这个文件，通过fp就可以对文件进行各种操作。也就是说，通过文件指针变量能够找到与之关联的文件。

**老师点评**

暂无评语

**+ 4.0 分**

7 . `单选题` `中等` `4分`

```c
fopen函数中正确的文件名参数写法是（ ）。

A.c:\user\text.txt

B.c:\\user\\text.txt

C."c:\user\text.txt"

D."c:\\user\\text.txt"✅
```

回答正确

**解析**

参数filename表示文件名，可以是相对路径，如"A.TXT"（当前目录下A.TXT文件）、"SUB\\A.TXT"（SUB子目录下A.TXT文件）、"..\\A.TXT"（上一级目录下A.TXT文件），也可以是绝对路径，如"C:\\A.TXT"（C盘根目录下A.TXT文件）、"D:A.TXT"（D盘当前目录下A.TXT文件）等。请注意，文件系统路径表示的反斜线（\）写成字符串时应该用转义字符（\\）。参数filename可以是字符串常量，也可以是字符串变量。

**老师点评**

暂无评语

**+ 3.0 分**

8 . `单选题` `简单` `3分`

```c
若要用fopen函数创建一个新的二进制文件，该文件既要能读也能写，则文件打开方式应是（ ）。

A."ab+"

B."wb+"

C."rb+"

D."ab"
    //重点:创建新的
```

回答正确

**解析**

FILE *fopen(const char *filename, const char *mode);其中mode参数取值： "rb"	打开一个文件用于只读数据，文件不存在时打开失败。 **"rb+"或"r+b"	打开一个文件用于读写数据，文件不存在时打开失败**。 "wb"	创建一个新文件用于只写数据，新文件会覆盖旧文件。 "wb+"或"w+b"	创建一个新文件用于读写数据，新文件会覆盖旧文件。 "ab"	打开一个文件用于追加数据，文件不存在时创建新文件。 "ab+"或"a+b"	打开一个文件用于追加和读数据，文件不存在时创建新文件。

**老师点评**

暂无评语

**+ 3.0 分**

9 . `单选题` `简单` `3分`

```c
若以"a+"方式打开一个已存在的文件，以下叙述中正确的是（ ）。

A.文件打开时，原有文件内容不被删除，位置指针移到文件末尾，可作添加和读操作✅

B.文件打开时，原有文件内容不被删除，位置指针移到文件开头，可作重写和读操作

C.文件打开时，原有文件内容被删除，只可作写操作

D.以上说法都不正确
```

回答正确

**解析**

"a+"或"at+"或"a+t" 打开一个文件用于追加和读数据，文件不存在时创建新文件。

**老师点评**

暂无评语

**+ 3.0 分**

10 . `单选题` `简单` `3分`

```c
在文件打开方式中，字符串"rb"表示（ ）。

A.打开一个已存在的二进制文件，只能读取数据✅

B.打开一个文本文件，只能写入数据

C.打开一个已存在的文本文件，只能读取数据

D.打开一个二进制文件，只能写入数据
```

回答正确

**解析**

"rb"	打开一个文件用于只读数据，文件不存在时打开失败。

**老师点评**

暂无评语

**+ 4.0 分**

11 . `单选题` `简单` `4分`

```c
以“w”方式打开文本文件a:\aa.dat，若该文件已存在，则（ ）。

A.新写入数据被追加到文件末尾

B.文件被清空，从文件头开始存放新写入数据✅

C.显示出错信息

D.新写入数据被插入到文件首部
```

回答正确

**解析**

"w"或"wt" 创建一个新文件用于只写数据，新文件会覆盖旧文件。

**老师点评**

暂无评语

**+ 3.0 分**

12 . `单选题` `简单` `3分`

```
在C程序中，可把整型数据以二进制形式存放到文件中的函数（ ）。

A.fprint

B.fputs

C.fwrite✅

D.fputc
```

回答正确

**解析**

fwrite函数将指定数目指定记录大小的数据块写入文件中，其函数原型为： size_t fwrite(const void *buffer, size_t size, size_t count, FILE *stream); 

fwrite函数参数含义与fread相同，

fwrite函数输出时不会进行任何编码转换、插入数据等操作，即直接将内存数据送到文件中。

**老师点评**

暂无评语

**+ 0.0 分**

13 . `单选题` `简单` `3分`

```c
fgetc函数的作用是从指定文件读入一个字符，该文件的打开方式必须是（ ）。

A.只写

B.追加

C.读或读写✅

D.B和C都正确
```

**解析**

fgetc函数从文件中读入一个字符数据，其函数原型为： int fgetc(FILE *stream); //读文件字符数据函数 参数stream是已打开的文件指针，该文件必须是以读或读写方式打开的。

**老师点评**

暂无评语

**+ 4.0 分**

14 . `单选题` `简单` `4分`

```c
函数调用语句fseek(fp,-20L,2)的含义是（ ）。

A.将文件位置指针移到距离文件头20个字节处

B.将文件位置指针从当前位置向后移动20个字节

C.将文件位置指针从文件末尾向后退20个字节✅

D.将文件位置指针移到当前位置20个字节处
```

回答正确

**老师点评**

暂无评语

**+ 3.0 分**

15 . `单选题` `简单` `3分`

```c
函数rewind的作用是（ ）。

A.使位置指针重新返回文件的开头✅

B.将位置指针指向文件中所要求的特定位置

C.使位置指针指向文件的末尾

D.使位置指针自动移至下一个字符位置
```

回答正确

**解析**

rewind函数使文件位置重新回到文件开头，其函数原型为： void rewind(FILE *stream); 参数stream是已打开的文件指针。

**老师点评**

暂无评语

**+ 3.0 分**

16 . `单选题` `简单` `3分`

```c
函数ftell(fp)的作用是（ ）。

A.得到流式文件中的当前位置✅

B.移动流式文件的位置指针

C.初始化流式文件的位置

D.以上答案均正确
```

回答正确

**解析**

ftell函数返回当前文件位置，其函数原型为： long ftell(FILE *stream); 参数stream是已打开的文件指针。

**老师点评**

暂无评语

**+ 3.0 分**

17 . `单选题` `简单` `3分`

```c
若有定义FILE* fp;且fp指向的文件未结束，则函数feof(fp)的返回值为（ ）。

A.0✅

B.true

C.非0

D.false
```

回答正确

**解析**

读取文件时需要检测是否已经到了文件末尾，以此判断文件读取工作是否应该结束。标准C语言提供了一个feof函数来判断是否已到文件末尾，其函数原型为： int feof(FILE *stream); 参数stream是待检测的文件指针。如果文件已到末尾函数返回真（1），否则返回假（0）。

**老师点评**

暂无评语

**+ 6.0 分**

18 . `单选题` `中等` `6分`

下面程序执行后所操作的文件中结果是（ ）。

```c
#include <stdio.h>
void WriteStr( char *fn, char *str )
{
	FILE *fp;
	fp = fopen( fn, "w" );//覆盖旧文件
	fputs( str, fp );
	fclose( fp );
}

int main()
{
	WriteStr( "t1.dat", "start" );
	WriteStr( "t1.dat", "end" );
	return(0);
}
```

A.start

B.end✅

C.startend

D.endstart

回答正确

**解析**

"w"或"wt"	创建一个新文件用于只写数据，新文件会覆盖旧文件。

**老师点评**

暂无评语

**+ 6.0 分**

19 . `单选题` `中等` `6分`

下面程序执行后的输出结果是（ ）。

```c
#include <stdio.h>
int main()
{
	FILE	*fp;
	int	i, k, n;
	fp = fopen( "data.dat", "w+" );
	for ( i = 1; i < 6; i++ )
	{
		fprintf( fp, "%d ", i );
        
		if ( i % 3 == 0 )
			fprintf( fp, "\n" );
        //1 2 3
        //4 5
	}
	rewind( fp );
	fscanf( fp, "%d%d", &k, &n );//1 2
	printf( "%d %d", k, n );
	fclose( fp );
	return(0);
}
```

A.0 0

B.5 6

C.3 4

D.1 2✅

回答正确

**解析**

"w+"或"wt+"或"w+t"	创建一个新文件用于读写数据，新文件会覆盖旧文件。 文件中的内容为“1 2 3 \n4 5”

**老师点评**

暂无评语

**+ 6.0 分**

20 . `单选题` `中等` `6分`

下面程序执行后的输出结果是（ ）。

```c
#include <stdio.h>
int main()
{
	FILE *fp; int i = 20, j = 30, k, n;
	fp = fopen( "d1.dat", "w" );
	fprintf( fp, "%d\n", i );
	fprintf( fp, "%d\n", j );
	fclose( fp );
	fp = fopen( "d1.dat", "r" );
	fscanf( fp, "%d%d", &k, &n );
	printf( "%d %d\n", k, n );
	fclose( fp );
	return(0);
}
```

A.20 30✅

B.20 50

C.30 50

D.30 20

回答正确

**解析**

"w"或"wt"		创建一个新文件用于只写数据，新文件会覆盖旧文件。 文件中的内容为“20 \n30”

**老师点评**

暂无评语

**+ 3.0 分**

21 . `单选题` `中等` `3分`

```
【提高题】C语言中，系统自动打开的文件是（ ）。

A.二进制文件

B.随机文件

C.非缓冲文件

D.设备文件✅
```

回答正确

**解析**

通常，系统会为每个程序自动定义并打开**三个标准文件**，分别是**标准输入文件stdin（键盘）、标准输出文件stdout（显示器）、标准出错输出stderr（显示器）**，程序可直接使用它们。例如从文件指针stdin中读取数据就是从键盘上输入数据。

**老师点评**

暂无评语

**+ 6.0 分**

22 . `填空题` `中等` `6分`

有以下程序：

```c
#include <stdio.h>
int main()
{
	FILE *fp1;
	fp1 = fopen( "f1.txt", "w" );//覆盖
	fprintf( fp1, "abc" );
	fclose( fp1 );
	return(0);
}
```

若文本文件f1.txt中原有内容为good，则运行程序后文件f1.txt中的内容为 

___。

**答案**

abc

**解析**

"w"或"wt"	"wb"	创建一个新文件用于只写数据，新文件会覆盖旧文件。因此f1.txt原有内容会被覆盖。

**老师点评**

暂无评语

**+ 6.0 分**

23 . `填空题` `困难` `6分`

下面程序执行后，写出test.txt文件的内容___。

```c
#include <stdio.h>
int main()
{
	FILE	*fp;
	char	*s1 = "Fortran", *s2 = "Basic";
	if ( (fp = fopen( "test.txt", "wb" ) ) == NULL )
	{
		printf( "不能打开文件\n" ); return(-1);
	}
	fwrite( s1, 7, 1, fp );//Fortran
	fseek( fp, 0L, SEEK_SET );//rewind
	fwrite( s2, 5, 1, fp );
    //Basic
    //Fortran
    //Basican
	fclose( fp );
	return(0);
}
```

**学生答案**

Basican

回答正确

**答案**

Basican

**解析**

fseek函数使文件位置移到任意位置，其函数原型为： int fseek(FILE *stream, long offset, int origin); 参数stream是已打开的文件指针。参数origin表示移动时相对初始点，它必须是如下几个符号常量之一： #define	SEEK_SET	0	//移动时相对初始点为文件开头 #define	SEEK_CUR	1	//移动时相对初始点为文件当前位置 #define	SEEK_END	2	//移动时相对初始点为文件末尾 参数offset表示移动的偏移量（相对于初始点），以字节为单位，如果为正值表示文件位置向前（远离文件头），为负值表示文件位置向后（趋向文件头）。 因此，fseek(fp,0L,SEEK_SET);语句执行后将文件位置指针重新设置在文件开头，fwrite(s2,5,1,fp);执行时将从文件开头位置开始写入s2的内容，会部分覆盖掉fwrite(s1,7,1,fp);写入文件的s1的内容。

**老师点评**

暂无评语

**+ 6.0 分**

24 . `填空题` `困难` `6分`

写出下面程序执行后的运行结果___。

```c
#include <stdio.h>
int main()
{
	int	i, a[4] = { 1, 2, 3, 4 }, b;
	FILE	*fp;
	fp = fopen( "data.dat", "wb" );
	for ( i = 0; i < 4; i++ )
		fwrite( &a[i], sizeof(int), 1, fp );
    //1 2 3 4
    //3
	fclose( fp );
	fp = fopen( "data.dat", "rb" );
	fseek( fp, -2L * sizeof(int), SEEK_END );
	fread( &b, sizeof(int), 1, fp );
	fclose( fp );
	printf( "%d", b );
	return(0);
}
```

**答案**

3

**解析**

fseek函数使文件位置移到任意位置，其函数原型为： int fseek(FILE *stream, long offset, int origin); 参数stream是已打开的文件指针。参数origin表示移动时相对初始点，它必须是如下几个符号常量之一： #define	SEEK_SET	0	//移动时相对初始点为文件开头 #define	SEEK_CUR	1	//移动时相对初始点为文件当前位置 #define	SEEK_END	2	//移动时相对初始点为文件末尾 参数offset表示移动的偏移量（相对于初始点），以字节为单位，**如果为正值表示文件位置向前（远离文件头），为负值表示文件位置向后（趋向文件头）**。 因此，fseek(fp,-2L*sizeof(int),SEEK_END);语句执行后将文件位置指针从文件末尾向文件头方向移动两个整数的位置，即文件位置指针被重置在整数3的前面。后续读取文件时将从整数3开始读取。

**老师点评**

暂无评语

**+ 4.0 分**

25 . `填空题` `困难` `6分`

下面程序的功能是键入一个字符串，将该字符串分别写到文本文件（te.dat）和二进制文件（bi.dat）中。请填空使程序完整、正确。

```c
#include <stdio.h>
int main()
{
	char str [80];
	___;
	gets( str ); puts( str );
	te	= fopen( "te.dat", "wt" );
	bi	= fopen( "bi.dat", "wb" );
	___;    /*输出到文本文件中*/
	___;    /*输出到二进制文件中*/
	fclose( te ); fclose( bi );
	return(0);
}
/*
buffer ： 数据存储的地址

size ： 要读取的字节的大小

count : 要读取多少个size大小

stream : 等待被读取的数据源，它是一个指向FILE结构的文件指针
*/
```

**答案**

`FILE*te,*bi、fputs(str,te)、fwrite(str,sizeof(str),1,bi)`

**解析**

fwrite函数将指定数目指定记录大小的数据块写入文件中，其函数原型为： size_t fwrite(const void *buffer, size_t size, size_t count, FILE *stream); fwrite函数参数含义与fread相同，fwrite函数输出时不会进行任何编码转换、插入数据等操作，即直接将内存数据送到文件中。

**老师点评**

暂无评语

1 . `编程题` `中等` `50分`

**文件操作大小写字母转换**

编程输入一个字符串，将其中的小写字母转换成大写字母后输出到磁盘文件“D:\upper.txt”中保存(输入的字符串以“！”结束)。然后再将文件中的内容读出显示在屏幕上。

```c
#include<stdio.h>
#include<stdlib.h>
#include<ctype.h>
int main()
{
    char s[101];
    gets(s);
    for (int i = 0;s[i]!=0; i++)
      if (islower(s[i]))
          s[i]=s[i]-32;
    //写
    FILE *fp=fopen("D:\\upper.txt","w");
    //防御性编程
    if(fp==NULL)
      exit(0);
    fputs(s,fp);
    fclose(fp);
    //读 
    fp=fopen("D:\\upper.txt","r");   
    //防御性编程
    if(fp==NULL)
      exit(0);
    int read;
    while ((read=fgetc(fp))!=EOF)
      putchar(read);
    fclose(fp);
}
```

2 . `编程题` `中等` `50分`

**文件操作删除字符**

编程从文本文件“D:\from.txt”中读出所有内容，删除其中的数字字符后写入另一文本文件“D:\to.txt”中；再从文件“D:\to.txt”中读出内容并在屏幕上显示。

```c
#include<stdio.h>
#include<stdlib.h>
#include<ctype.h>

int main()
{
    char str[1001];//保存from.txt的字符
    FILE *fp;
    fp=fopen("D:\\from.txt","r");
    if(fp==NULL)
      exit(0);
    int read,i=0;
    while ((read=fgetc(fp))!=EOF)
        if (!isdigit(read))
            str[i++] = (char)read;
    str[i]=0;//补'\o'
    fclose(fp);   
    fp=fopen("D:\\to.txt","w+");//写了以后读
    if(fp==NULL)
      exit(0);
    //写
    fputs(str,fp);
    //读
    rewind(fp);//重启指针
    while ((read=fgetc(fp))!=EOF)
      putchar(read);
    fclose(fp);
    return 0;
}
```
